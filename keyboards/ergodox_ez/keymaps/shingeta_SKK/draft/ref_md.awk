$0 ~ /^\[\^[0-9]+\]: / {
    n = gensub(/^\[\^([0-9]+)\]: .*$/, "\\1", "g", $0)
    $0 = gensub(/^\[\^([0-9]+)\]: /, "<span id=foot\\1>\\1</span>: ", "g", $0)
    $0 = $0 "[â†©](#body" n ")" "\r\n"
}

$0 ~ /\[\^[0-9]+\]/ {
    $0 = gensub(/\[\^([0-9]+)\]/, "<span id=body\\1><sup>[\\1](#foot\\1)</sup></span>", "g", $0)
}

{
    print $0
}
